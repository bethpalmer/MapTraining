<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Maps Training</title>
	<style>
		html,
		body {
			font-family: Arial, sans-serif;
			height: 100%;
			margin: 0;
			padding: 0;
		}
		#map {
			height: 100vh;
		}
	</style>
</head>
<body>

	<div id="map"></div>

	<script>
		
		function initMap(){
			var map;
			// Constructor creates a new map, only need lat/lng and zoom
			map = new google.maps.Map(document.getElementById('map'), {
				center: {lat: 50.827022, lng: -0.158278},
				zoom: 14
			});
			
			var markers = [];

			var largeInfowindow = new google.maps.InfoWindow();

			var bounds = new google.maps.LatLngBounds();

			var locations = [
				{title: 'Sherbourne Road', location: {lat: 50.8514787, lng: -0.2010216}},
				{title: 'Adur Drive', location: {lat: 50.8360303, lng: -0.265268}},
				{title: 'Wilbury Road', location: {lat: 50.8325629, lng: -0.1669776}},
				{title: 'New Road', location: {lat: 50.874511, lng: 0.0061245}},
				{title: 'Coronation Street', location: {lat: 50.8332678, lng: -0.1265189}},
				{title: 'Cambridge Road', location: {lat: 50.826212, lng: -0.1593031}},
				{title: 'Middle Street', location: {lat: 50.8215338, lng: -0.1453002}},
				{title: 'Tivoli Cresc', location: {lat: 50.8427806, lng: -0.1600604}}
			];

			for (var i=0; i < locations.length; i++){
				var postion = locations[i].location;
				var title = locations[i].title;
				var marker = new google.maps.Marker({
					map: map,
					position: postion,
					title: title,
					animation: google.maps.Animation.DROP,
					id: i
				});
				// push the marker to our array of markers
				markers.push(marker);
				// extend the bounds of what is displayed on the map
				bounds.extend(marker.position);
				// create an onclick event to open an info window at each marker
				marker.addListener('click', function(){
					populateInfoWindow(this, largeInfowindow);
				});
			}
			map.fitBounds(bounds);
		}

		// This function populates the infowindow when the marker is clicked. Only allows one info window to open, and populates based on markers position.
		function populateInfoWindow(marker, infowindow){
			// check to make sure infowindow is not already open
			if (infowindow.marker != marker) {
				infowindow.marker = marker;
				infowindow.setContent('<div>' + marker.title + '</div>');
				infowindow.open(map, marker);
				// make sure the marker property is cleared if the infowindow is closed
				Infowindow.addListener('closeclick', function(){
					infowindow.setMarker(null);
				})
			}
		}
	</script>

	<script async defer
     src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyAoEnMQe4ZX1tFEinO8c3XUHt7AHO0ipEM&callback=initMap">
    </script>
</body>
</html>